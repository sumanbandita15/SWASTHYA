'use strict';var cov_2dq9s8zl66=function(){var path="C:\\Users\\suman\\Desktop\\Swasthya\\server\\passport\\jwt.js",hash="44f40a14059030577f341e0d04fd4d87635c2fdf",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"C:\\Users\\suman\\Desktop\\Swasthya\\server\\passport\\jwt.js",statementMap:{"0":{start:{line:2,column:46},end:{line:2,column:69}},"1":{start:{line:4,column:17},end:{line:4,column:42}},"2":{start:{line:5,column:23},end:{line:5,column:43}},"3":{start:{line:7,column:20},end:{line:18,column:1}},"4":{start:{line:16,column:4},end:{line:16,column:29}},"5":{start:{line:20,column:0},end:{line:20,column:33}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:15,column:2},end:{line:15,column:3}},loc:{start:{line:15,column:21},end:{line:17,column:3}},line:15}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},f:{"0":0},b:{},_coverageSchema:"d34fc3e6b8297bcde183f5492bcb8fcb36775295"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const{Strategy:JwtStrategy,ExtractJwt}=(cov_2dq9s8zl66.s[0]++,require('passport-jwt'));const{User}=(cov_2dq9s8zl66.s[1]++,require('../models/user'));const{JWT_SECRET}=(cov_2dq9s8zl66.s[2]++,require('../config'));const jwtStrategy=(cov_2dq9s8zl66.s[3]++,new JwtStrategy({secretOrKey:JWT_SECRET,// Look for the JWT as a Bearer auth header
jwtFromRequest:ExtractJwt.fromAuthHeaderWithScheme('Bearer'),// Only allow HS256 tokens - the same as the ones we issue
algorithms:['HS256']},(payload,done)=>{cov_2dq9s8zl66.f[0]++;cov_2dq9s8zl66.s[4]++;done(null,payload.user);}));cov_2dq9s8zl66.s[5]++;module.exports={jwtStrategy};